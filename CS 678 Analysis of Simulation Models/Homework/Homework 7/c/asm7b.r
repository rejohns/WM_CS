n1 = 6
n2 = 7
n3 = 5
n = n1 + n2 + n3
k = 3

u = c(1, 7, 49, 38, 22, 32, 41, 43, 57, 33, 48, 31, 34, 55, 19, 11, 16, 51, 52, 59, 47, 24, 46, 17, 58, 40, 36, 8, 56, 26, 60, 54, 12, 23, 39, 29, 20, 18, 4, 28, 13, 30, 27, 6, 42, 50, 45, 10, 9, 2, 14, 37, 15, 44, 3, 21, 25, 53, 5, 35)

u = u / 61

u = sort(u)

t = c(0, 240, 38, 137, 141, 143, 168, 197, 18, 69, 117, 121, 147, 157, 237, 47, 127, 131, 139, 147)

t = sort(t)

y = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

v = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for(i in 1:20) {
	y[i] = (i * n) / ((n + 1) * k)
}

max = max(y)
y = y / max 

plot(t, y, type = "o")

for (i in 1:60) {
	n = u[i]
	j = 1
	if(n < y[j]) {
		v[j] = 0
	}
	else {
		while(n < y[j]) {
			j = j + 1
		}
		j = j - 1
	
		v[i] = ((n - y[j]) * (t[j+1] - t[j]) / (y[j+1] - y[j])) + t[j+1]
	}
}